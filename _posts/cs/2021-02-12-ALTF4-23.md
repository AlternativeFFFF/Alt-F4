## Vypočítánín pouze s pásy, část první: Ne-tak-rychlá matematika <author>pocarski</author>

V Factoriu, můžeme již použít ovládací síť na stavění systémů, začínající s lehkou binární logikou, až na kompletně funční počítač, a poté, někdo dost šílený příjde s tím, že [na tom hraje DOOM](https://www.youtube.com/playlist?list=PLdkxm81SV4uVs7EHAxeGcaPLe9xX_7tjb). Co je ale méně zřejmé, je ale fakt že ovládací síť není pouze jediný [Turingově uplný](https://en.wikipedia.org/wiki/Turing_completeness) (podívejte se na odkázanou stránku pokud si nejste známí) systém ve hře. Vskutku, jste schopni postavit počítač z čehokoli základního, něco co dostanete skoro na začátku hry: pásy (transportéery).

V této dvoudílné sérii vás budu provázet procesem designování dvou systémů používaných v realitě s ničím jiným kromě pásů a rodzělovačů. Budu používat nakládače a nekonečné truhly, ale kdykoliv přichází stejné množství entit co odchází, takže všechny pásy by mohly být propojeny zkrz buffer. Nerozhodl jsem se to dělat kvůli kompaktnosti a vybýbání se špagetovému designu. Musím dát zásluhu uživateli [letao12](https://www.youtube.com/channel/UC6BeS4toXnPJe-Kds9E_FEQ), který udělal sérii videí o vyrábění CPU s použitím pouze pásů, což je věc, která mě inspirovala k vrácení se k jeho nápadu s mým vlastním pohledem na věc. 

Aby jakýkoli systém byl Turingově úplný, musí být možnost vytvořit takzvaná logická hradla. Logická hradla jsou lehké elementy, které provádí základní operace [binární algebry](https://en.wikipedia.org/wiki/Boolean_algebra) způsobem vracení výstupu, který je založen pouze na aktuálních vstupech. Jsou pouze dvě čísla v binární algebře: 1 a 0. V elektronikách, korespondují k vysokému a nízkému napětí, ale v našem případě, řekněme, že pásy s itemy jsou 1 a prázdné pásy jsou 0. Existují 3 základní logická hradla:

* OR hradlo - vrací 1 **když aspoň jeden** vstup je 1
* AND hradlo - vrací 1 **pokud všechny** vstupy jsou 1
* NOT hradlo - vrací 1 **pouze když** vstup je 0

Pravdivostní tabulka níže ukazuje jejich respektivní výstupy založeny na výběru možných vstupů.

| A    | B    | NOT A | A OR B | A AND B |
| ---- | ---- | ----- | ------ | ------- |
| 0    | 0    | 1     | 0      | 0       |
| 0    | 1    | 1     | 1      | 0       |
| 1    | 0    | 0     | 1      | 0       |
| 1    | 1    | 0     | 1      | 1       |

Je známým faktem, že když tyto hradla změníte specifickýmy způsoby (a někdy vytváření smyčky drátů), je možné vytvořit [Turingův stroj](https://en.wikipedia.org/wiki/Turing_machine). Všechny tři základní logická hradla mohou být vytvořena s pásy a rozdělovači. Nechci, aby lidé skrolovali přes tunu obrázků celou hodinu, takže ukážu pouze výchozí fázi, všechny-vstupy-nulové, pro většinu okruhů. Zde je odkaz na [knihu plánů](https://media.alt-f4.blog/ALTF4/23/belt-computer-blueprint-book.txt) se vším z tohoto článku, pro kohokoli, kdo by chtěl sám experimentovat s obvody. Budu odkazovat k různým itemům jako "item druhu 1/2/3/...", pro pohodlí a obecnost, a prioritní/neprioritní výstupy jako "primární/sekundární", spíše z pohodlí. Budu také používat jiné barvy v obrázcích, aby bylo rozpoznávat mezi druhy itemů.

## Základní hradlo

AND a OR hradlo jsou lehké jako jeden rozdělovač s nastavenou prioritou: 

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/and_and_or.jpg' alt='Jeden rozdělovač, který se chová jako AND a OR hradlo najednou' caption='Primární výstup se chová jako OR hradlo, mezitím co sekundární výstup se chová jako AND hradlo.' %}

NOT hradlo je tročku těžší na výrobu, ale může být vyrobeno s vícero druhů itemů a chytrou mechanikou filtrování a prioritizování:

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/very_useful_circuit.jpg' alt='Kombinované NOT hradlo a signálový duplikátor' %}

Mezitím co *vstup A* je 0, první rozdělovač dostává pouze jeden vstup, a tak item druhu 2 půjde do primárního vstupu, což znamená pouze *NOT A výstup* je 1. Když vstup A je zapnutý, první rozdělovač nyní získává dva vstupy; item druhu 1 jde na primární vstup, tak je dán na primární výstup, nahrazující item druhu 2, který teď vystupuje z sekundárního výstupu. Sekundární výstup je efektivně kopie A, ale s různým druhem itemů.

Primární výstup prvního rozdělovače je vždy 1, ale mění druh itemu záležící na vstupu. Použitím prvního rozdělovače, jsme schopni rozdělit hodnotu druhu itemu na 2 dráty: jeden bude pouze signál A přicházející rovnou zkrz s stejným druhem itemu jako originální vstup, typ 1, a druhý bude *NOT A*, s itemovým druhem 2.

Druhý obvod je výjmečně užitečný, protože kombinuje NOT hradlo, signálový duplikátor, a měnič itemů. Potřebujeme signálové duplikátory, protože větvení pásu s rozdělovačem nechá tok itemů nezasycený, což nechává interakci s ostatními rozdělovači špatnou, protože to není 0 ani 1. Také potřebujeme měniče itemů, protože je často nesoulad mezi výstupem ovládací sítě a vstupu jiné věci.

### Poloviční sčítač

Teď když máme základní tři komponenty, postavme poloviční sčítač. *K čemu by byl poloviční sčítač?* No, jak jméno může napovídat, poloviční sčítač je polovina plného sčítače, což je obvod, který má schopnost sčítat binární čísla. Toto nám umožní provádět sčítání, a kreativní použití sčítání nám umožní implementovat *doslova* jakoukoli jinou matematickou operaci která existuje.

Poloviční sčítač je obvod, který sčítá dvě jednočíselné binární čísla. Toto může znít jako komplikovaná činnost, ale v realitě, je to velmi lehké. Oba vstupy A a B jsou jsou jednočíselná binární čísla, což znamená že maximální možný výstup je 2 (1+1), což, bohužel, se nevejde do jediného výstupu. Místo toho, použijeme dvoučíselnou binární hodnotu, kde první číslo má hodnotu 2 (2<sup>1</sup>) a druhé číslo má hodnotu 1 (2<sup>0</sup>). Když toto vezmeme v potaz, zde je pravdivostní tabulka polovičního sčítače:

| A    | B    | První číslo A + B | Druhé číslo A + B    |
| ---- | ---- | ----------------- | -------------------- |
| 0    | 0    | 0                 | 0                    |
| 0    | 1    | 0                 | 1                    |
| 1    | 0    | 0                 | 1                    |
| 1    | 1    | 1                 | 0                    |

Můžeme si všimnout, že první číslo je pouze *A A B*. Nicméně, pro druhé číslo, potřebujeme věc nazývanou XOR hradlo (XOR znamená "exklusivní OR"). XOR hradlo má výstup 1 pokud **pouze 1** vstup je 1, což je přesně co potřebujeme na druhé číslo.

Logika XOR hradla je, "A nebo B, ale ne oboje", a proto je XOR hradlo pouze *(A NEBO B) A NE (A A B)*. Zde je jak se toto vytvoří s základními hradly, která jsem vysvětlil předtím:

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/half_adder.jpg' alt='Poloviční sčítač' %}

Všimněte si, že dostaneme výstup AND hradla zdarma díky kombinovanému duplikátor-NOT hradlu, což nám dává kompletní poloviční sčítač. Je náhoda, že můžeme kombinovat první měnič itemů s druhým AND hraldem, což nám umožnuje odstranit rozdělovač:

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/simpler_half_adder.jpg' alt='Trochu lehčí poloviční sčítač'%}

### Finální produkt

Tak, aby jsme změnili náš poloviční sčítač na plný sčítač, potřebujeme připojit dva za sebou (proto jméno "poloviční sčítač"):

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/full-adder-diagram.jpg' alt='Diagram plného sčítače' %}

Jak můžete vidět, plný sčítač jsou pouze dva poloviční sčítače dány dohromady v specifickém způsobu. Teď, mohli bychom pouze kopírovat a vložit tento obvod, ale díky vlastnostem pásů, existuje mnohem lepší a menší způsob. Dvě poloviny pásů jsou procesovány odděleně od sebe, což znamená že místo toho abychom dávali dva poloviční sčítače, jsme schopni **nechat všechno běžět skrz poloviční sčítač dvakrát**. Toto je většinou nemožné s tradičnímy logickýmy hradly, ale v tomto novém světě Factorio počítačů, cokoliv existuje. Zde je jak:

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/spread_out_full_adder.jpg' alt='Plný sčítač' %}

Zde, první poloviční sčítač používá pravou stranu pásu a druhý poloviční sčítač používá levou část pásu. První, vstupy projdou zkrz první poloviční sčítač normálně na pravé straně pásu. Poté, XOR hradlo polovičního sčítače je vráceno až na začátek a je dáno na levou část pásu. Projde kdrz stejné mechanizmy znovu, ale protože je to na levé straně, nemá vůbec interakci s pravou stranou pásu. Druhý poloviční sčítač pořád má volný výstup, takže ho musíme připojit na třetí vstupový pás, tentokrát na levé straně, aby se to chovalo jako *přenosová* část. AND výstup obou polovičních sčítačů je bočně naložen na jeden pás, automaticky vytvářející OR. Interní spoždění mohou poloviční sčítače posunout výstup ve stejný čas, tímpádem se bude snažit naložit dva celé pásy na půl pásu. Proto potřebujeme přidat přetokový rozdělovač aby se přenos nezastavil a nezničil celý obvod. Po přeskupení některých komponentů, získáme toto:

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/compacted_full_adder.jpg' alt='Kompaktní plný sčítač' %}

Toto je *přesně* stejný obvod jako v minulém obrázku, a nechám to jako cvičení pro čtenáře aby to ověřil. Jediná věc, která zbývá je naskládat několik těchto obvodů dohromady a dát jim čísla, takže zde je pásový sčítač, který sčítá 01001101 (77) + 10001011 (139) = 011011000 (216):

{% include image.html src='https://media.alt-f4.blog/ALTF4/23/8_bit_adder.jpg' alt='Několik sčítačů počítajících 01001101 (77) + 10001011 (139) = 011011000 (216)' %}

Sčítání čísel je hezké, ale není to nic bez jakékoli paměti, což bude přesně to, co budu dělat při příštím vydání. Zůstaňte naladěni!