<!DOCTYPE html>
<html lang="zh" class="zh">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Alt-F4 #53 - 自动化偷懒</title>
	<!-- Meta -->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.1.1">
<meta property="og:title" content="Alt-F4 #53 - 自动化偷懒">
<meta name="author" content="Therenas">
<meta property="og:locale" content="zh">
<meta name="description" content="在地处黄金地段的第 53 期 Alt-F4 中，Therenas 大师又回来恩赐予我们一篇新文章。承接他之前着重于谈论自己 Mod 的杰作，这次是全新的复刻内容大放送。本期探讨了异星工厂中自动截图的话题。虽然实际内容只有 20% 的技术细节，此外加上 40% 的哲学和 50% 的冷笑话。你没看错，合计高达 110 点！ 自动化偷懒 Therenas 我经常苦恼于为我的 Mod 拍摄适当的截图。要把一个场景设置得很吸引人 并且 以视觉方式解释 Mod 的核心概念，需要做很多工作。在我看来，很多 Mod 缺乏优秀截图，并非由于 Mod 作者不关心，而是因为制作好的截图真的很困难。虽说 一图胜千言，但截图需要他们用相当有限的“语言”做大量的工作。 尽管这一切听起来像在发牢骚（也确实如此），但实际问题不在于截图本身。在你花了几十个或几百个小时来做出这个 Mod 之后，再花几个小时为这个 Mod 截图是完全可以接受的。实际的问题是保持它们更新。你对 Mod 所做的每一个改动，最好都能在更新的截图内反映出来；如果截图过时了，对我来说就是一种缺乏关注的信号。当然也可能是我太过偏执。 当然更新的频率取决于每个 Mod 自己。如果是瓶颈这种不常改变的，那你的截图就不会过时。如果你是一个相当复杂的 GUI Mod，几乎每个版本都会在这里或那里改变你的界面的一些像素。理想情况下，一个耗时 5 分钟的 UI 修复应同时伴随更新截图，但这将让你花更多的时间在截图而非实际的开发工作上。没有人愿意这样做，因此截图总会随着时间的推移而过时。 人类心理学使这种影响更加复杂，并造成了一种恶性循环。如果你知道你的截图每隔一个版本就需要更新，你就会决定跳过更新它们，只跳这一次。下一版本无论如何都会有另一个变化，那么为什么还要现在去更新它们，这不是在浪费时间嘛。当下一个版本到来时，同样的心理会导致你再一次拖延。就这一次。永无止境地重复下去。 也许只有我是难以置信的懒惰，正常人不会有这样的问题。他们可能只会定期更新截图，因此大部分时间都会是最新的。但我不是。在实践中，它导致我大约每六个月更新一次截图。我为他们没有及时更新而烦恼，但“下次再做就好了”的心态在面对一周后就白干了的事实面前显得格外强烈。 不过，我还是想要一个解决方案。我需要一个解决方案，哪怕只是为了免除我对过期截图的自我愧疚。当然，这并不难做到。工作是不可能工作的，下周再做。自动化看来是应许之地，有时如此，有时确实如此。 我以前自动化过一些与 Mod 开发有关的流程，最知名的是构建一个新版本的流程和所有与此相关的细节管理。在这个特例中，这甚至不是因为我不想为我所有的版本做同样繁琐的步骤（至少 169 个版本的工厂规划师），更多的是为了防止我在这个过程中犯错，以免用户得到错误的版本等等，这可不妙。 快来截图吧！ 好了好了，让我们进入有趣的部分。我的想法很简单。写一个 Python 脚本来启动异星工厂进入一个自定义场景，然后接管实际的截图部分（感谢异星工厂有一个截图专用的 API 方法），之后脚本会把截图放到正确的文件夹中，也许会对它们进行一些裁剪。第一部分相当容易，我只需要弄清楚我需要哪些命令行参数，把它们串起来，然后场景就可以运行了。到目前为止，如此简单。 不过实际情况要复杂一些。为了能够截出有意义的图，我需要在不同的状态下设置各种 GUI，以显示我想要突出的功能。对地图上的实体做这种事情比较容易，因为你可以使用你通常使用的与游戏世界互动的所有 API。不过，对于 GUI 来说，它们有点自成一体，你必须构想出你自己的系统。 最大的问题来自于无法模拟一个实际的用户点击你的界面。游戏中没有任何此类 API 方法，因为任何实际的 Mod 都用不着。但这意味着你需要以某种方式来模拟点击。这有点尴尬，因为除非你的 Mod 从一开始就为此设置，或者结构非常好，否则你将需要重写你的事件处理程序或者整点黑科技。你也许能猜到我走的是哪条路。 在把黑科技整理好后，这玩意儿就能启动游戏，把界面设置成一个有趣的场景，并对用户界面的各个部分进行截图。我必须指出，所有这些都是勉强能跑，而且很有可能在 Mod 代码更改后出错。但在这一特殊情况下，没有真正的替代方案，所以我不得不忍受它。不管怎么说，建立一堆屎山代码要比一次又一次地手动拍摄相同的屏幕截图有趣得多，所以无论如何都是一种胜利。 到目前为止我对我所做的工作相当满意，但最大自动化尚未实现。你看，还有一个问题就是要把截图裁剪得更小。在工厂规划师中的许多对话框都比较小，而背景中的游戏世界会让人分心。我可以手动进行裁剪，但我不想这样做。懒。我的脑海中有一个潜在的解决方案，但它需要一些脏活。 基本想法是，在场景拍摄屏幕截图的同时，也记录下正在拍摄的对话框的尺寸。然后，这个元数据也被写入一个文件，Python 脚本可以用该文件来裁剪屏幕截图到合适的尺寸。听起来理论上是个好主意，但在现实中却遇到了一个小问题。游戏不允许你读取 GUI 窗口的尺寸，只允许写入尺寸。 禁止这么做还算合理的，因为这些尺寸实际上并不是在所有情况下都是确定的，例如，不同的游戏语言可能会改变某些元素的尺寸。在多人游戏中读取和使用这些不确定的值会导致不同步，使 Mod 与多人游戏不兼容，也会破坏重放。这似乎是一个死胡同。我是否注定要永远手动裁剪屏幕截图？事实证明，这并非我的命运。 现在，我无法解决读取对话框尺寸导致解同步的问题，这是游戏底层的运行方式。然而，我并没有在多人游戏中运行游戏来拍摄这些截图，事实证明，你已经可以在一个名为仪表模式的特殊模式下启动游戏，该模式禁用多人游戏并启用一些不安全功能。这似乎是一个完美的地方，可以塞进一个超级秘密的隐藏方法，使我能够获得关于对话框尺寸的禁忌知识。所以我就这么干了。事实证明，给 Wube 打工确实有好处。 经过几天的黑科技开发，这头野兽终于咆哮着活了过来，为我实现了屏幕截图过程的完全自动化。但还不是 完全 自动化流程。事实证明，它仍然没有完全自动化。它当然不是。我怎么会得到 完全 的满足呢。有两个步骤，我仍然需要自己做。 首先是在截图后退出游戏，以便 Python 脚本能继续执行。事实证明，Mod 不能让异星工厂退出到桌面。为了防止滥用，这是完全合理的，尽管对于仪表模式而言将是一个很好的选项。无论如何，在适当的时候按下 Alt-F4（叮）我想是能做到的。我有一个侵入性的想法，就是想办法让游戏崩溃以达到我的目的。我警告过你，这都是一堆黑科技。这个计划的问题是，游戏中很少有这样的 Bug，一旦被发现，你可以肯定 Bug 粉碎机会立即粉碎它们。 第二是将这些刚出锅的新截图上传到 Mod 门户。目前还没有合适的 API 来操作 Mod 门户网站的列表，所以我在这方面很不走运。现在，我不得不手动打开浏览器，逐一删除我的截图，然后逐一上传新的截图。真是悲剧！。也许将来会有此类 API 的希望，让我们拭目以待。 除了这两件事，我对这个结果很满意。我想这是值得的，因为我可以无限期地收获这个脚本的好处。自动化的乐趣。无限的收益。至少在它第一次坏掉之前是这样，而这可能很快就会发生。哦，好吧。 征稿 一如既往的，我们正在召集任何想要为 Alt-F4 做出贡献的人，无论是提交文章还是帮助翻译都可以。如果您有些有趣的想法，并乐于与社区分享，这里就是一个好地方。如果您没有太大把握，我们会很乐意帮助您讨论内容创意和结构问题。如果您有意参与，从加入 Discord 开始吧！">
<meta property="og:description" content="在地处黄金地段的第 53 期 Alt-F4 中，Therenas 大师又回来恩赐予我们一篇新文章。承接他之前着重于谈论自己 Mod 的杰作，这次是全新的复刻内容大放送。本期探讨了异星工厂中自动截图的话题。虽然实际内容只有 20% 的技术细节，此外加上 40% 的哲学和 50% 的冷笑话。你没看错，合计高达 110 点！ 自动化偷懒 Therenas 我经常苦恼于为我的 Mod 拍摄适当的截图。要把一个场景设置得很吸引人 并且 以视觉方式解释 Mod 的核心概念，需要做很多工作。在我看来，很多 Mod 缺乏优秀截图，并非由于 Mod 作者不关心，而是因为制作好的截图真的很困难。虽说 一图胜千言，但截图需要他们用相当有限的“语言”做大量的工作。 尽管这一切听起来像在发牢骚（也确实如此），但实际问题不在于截图本身。在你花了几十个或几百个小时来做出这个 Mod 之后，再花几个小时为这个 Mod 截图是完全可以接受的。实际的问题是保持它们更新。你对 Mod 所做的每一个改动，最好都能在更新的截图内反映出来；如果截图过时了，对我来说就是一种缺乏关注的信号。当然也可能是我太过偏执。 当然更新的频率取决于每个 Mod 自己。如果是瓶颈这种不常改变的，那你的截图就不会过时。如果你是一个相当复杂的 GUI Mod，几乎每个版本都会在这里或那里改变你的界面的一些像素。理想情况下，一个耗时 5 分钟的 UI 修复应同时伴随更新截图，但这将让你花更多的时间在截图而非实际的开发工作上。没有人愿意这样做，因此截图总会随着时间的推移而过时。 人类心理学使这种影响更加复杂，并造成了一种恶性循环。如果你知道你的截图每隔一个版本就需要更新，你就会决定跳过更新它们，只跳这一次。下一版本无论如何都会有另一个变化，那么为什么还要现在去更新它们，这不是在浪费时间嘛。当下一个版本到来时，同样的心理会导致你再一次拖延。就这一次。永无止境地重复下去。 也许只有我是难以置信的懒惰，正常人不会有这样的问题。他们可能只会定期更新截图，因此大部分时间都会是最新的。但我不是。在实践中，它导致我大约每六个月更新一次截图。我为他们没有及时更新而烦恼，但“下次再做就好了”的心态在面对一周后就白干了的事实面前显得格外强烈。 不过，我还是想要一个解决方案。我需要一个解决方案，哪怕只是为了免除我对过期截图的自我愧疚。当然，这并不难做到。工作是不可能工作的，下周再做。自动化看来是应许之地，有时如此，有时确实如此。 我以前自动化过一些与 Mod 开发有关的流程，最知名的是构建一个新版本的流程和所有与此相关的细节管理。在这个特例中，这甚至不是因为我不想为我所有的版本做同样繁琐的步骤（至少 169 个版本的工厂规划师），更多的是为了防止我在这个过程中犯错，以免用户得到错误的版本等等，这可不妙。 快来截图吧！ 好了好了，让我们进入有趣的部分。我的想法很简单。写一个 Python 脚本来启动异星工厂进入一个自定义场景，然后接管实际的截图部分（感谢异星工厂有一个截图专用的 API 方法），之后脚本会把截图放到正确的文件夹中，也许会对它们进行一些裁剪。第一部分相当容易，我只需要弄清楚我需要哪些命令行参数，把它们串起来，然后场景就可以运行了。到目前为止，如此简单。 不过实际情况要复杂一些。为了能够截出有意义的图，我需要在不同的状态下设置各种 GUI，以显示我想要突出的功能。对地图上的实体做这种事情比较容易，因为你可以使用你通常使用的与游戏世界互动的所有 API。不过，对于 GUI 来说，它们有点自成一体，你必须构想出你自己的系统。 最大的问题来自于无法模拟一个实际的用户点击你的界面。游戏中没有任何此类 API 方法，因为任何实际的 Mod 都用不着。但这意味着你需要以某种方式来模拟点击。这有点尴尬，因为除非你的 Mod 从一开始就为此设置，或者结构非常好，否则你将需要重写你的事件处理程序或者整点黑科技。你也许能猜到我走的是哪条路。 在把黑科技整理好后，这玩意儿就能启动游戏，把界面设置成一个有趣的场景，并对用户界面的各个部分进行截图。我必须指出，所有这些都是勉强能跑，而且很有可能在 Mod 代码更改后出错。但在这一特殊情况下，没有真正的替代方案，所以我不得不忍受它。不管怎么说，建立一堆屎山代码要比一次又一次地手动拍摄相同的屏幕截图有趣得多，所以无论如何都是一种胜利。 到目前为止我对我所做的工作相当满意，但最大自动化尚未实现。你看，还有一个问题就是要把截图裁剪得更小。在工厂规划师中的许多对话框都比较小，而背景中的游戏世界会让人分心。我可以手动进行裁剪，但我不想这样做。懒。我的脑海中有一个潜在的解决方案，但它需要一些脏活。 基本想法是，在场景拍摄屏幕截图的同时，也记录下正在拍摄的对话框的尺寸。然后，这个元数据也被写入一个文件，Python 脚本可以用该文件来裁剪屏幕截图到合适的尺寸。听起来理论上是个好主意，但在现实中却遇到了一个小问题。游戏不允许你读取 GUI 窗口的尺寸，只允许写入尺寸。 禁止这么做还算合理的，因为这些尺寸实际上并不是在所有情况下都是确定的，例如，不同的游戏语言可能会改变某些元素的尺寸。在多人游戏中读取和使用这些不确定的值会导致不同步，使 Mod 与多人游戏不兼容，也会破坏重放。这似乎是一个死胡同。我是否注定要永远手动裁剪屏幕截图？事实证明，这并非我的命运。 现在，我无法解决读取对话框尺寸导致解同步的问题，这是游戏底层的运行方式。然而，我并没有在多人游戏中运行游戏来拍摄这些截图，事实证明，你已经可以在一个名为仪表模式的特殊模式下启动游戏，该模式禁用多人游戏并启用一些不安全功能。这似乎是一个完美的地方，可以塞进一个超级秘密的隐藏方法，使我能够获得关于对话框尺寸的禁忌知识。所以我就这么干了。事实证明，给 Wube 打工确实有好处。 经过几天的黑科技开发，这头野兽终于咆哮着活了过来，为我实现了屏幕截图过程的完全自动化。但还不是 完全 自动化流程。事实证明，它仍然没有完全自动化。它当然不是。我怎么会得到 完全 的满足呢。有两个步骤，我仍然需要自己做。 首先是在截图后退出游戏，以便 Python 脚本能继续执行。事实证明，Mod 不能让异星工厂退出到桌面。为了防止滥用，这是完全合理的，尽管对于仪表模式而言将是一个很好的选项。无论如何，在适当的时候按下 Alt-F4（叮）我想是能做到的。我有一个侵入性的想法，就是想办法让游戏崩溃以达到我的目的。我警告过你，这都是一堆黑科技。这个计划的问题是，游戏中很少有这样的 Bug，一旦被发现，你可以肯定 Bug 粉碎机会立即粉碎它们。 第二是将这些刚出锅的新截图上传到 Mod 门户。目前还没有合适的 API 来操作 Mod 门户网站的列表，所以我在这方面很不走运。现在，我不得不手动打开浏览器，逐一删除我的截图，然后逐一上传新的截图。真是悲剧！。也许将来会有此类 API 的希望，让我们拭目以待。 除了这两件事，我对这个结果很满意。我想这是值得的，因为我可以无限期地收获这个脚本的好处。自动化的乐趣。无限的收益。至少在它第一次坏掉之前是这样，而这可能很快就会发生。哦，好吧。 征稿 一如既往的，我们正在召集任何想要为 Alt-F4 做出贡献的人，无论是提交文章还是帮助翻译都可以。如果您有些有趣的想法，并乐于与社区分享，这里就是一个好地方。如果您没有太大把握，我们会很乐意帮助您讨论内容创意和结构问题。如果您有意参与，从加入 Discord 开始吧！">
<link rel="canonical" href="https://alt-f4.blog/zh/ALTF4-53/">
<meta property="og:url" content="https://alt-f4.blog/ALTF4-53/">
<meta property="og:site_name" content="Alternative Friday Factorio Fan Facts">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2021-11-26T00:00:00+00:00">
<script type="application/ld+json">
{"dateModified":"2021-11-26T00:00:00+00:00","datePublished":"2021-11-26T00:00:00+00:00","author":{"@type":"Person","name":"Therenas"},"description":"在地处黄金地段的第 53 期 Alt-F4 中，Therenas 大师又回来恩赐予我们一篇新文章。承接他之前着重于谈论自己 Mod 的杰作，这次是全新的复刻内容大放送。本期探讨了异星工厂中自动截图的话题。虽然实际内容只有 20% 的技术细节，此外加上 40% 的哲学和 50% 的冷笑话。你没看错，合计高达 110 点！ 自动化偷懒 Therenas 我经常苦恼于为我的 Mod 拍摄适当的截图。要把一个场景设置得很吸引人 并且 以视觉方式解释 Mod 的核心概念，需要做很多工作。在我看来，很多 Mod 缺乏优秀截图，并非由于 Mod 作者不关心，而是因为制作好的截图真的很困难。虽说 一图胜千言，但截图需要他们用相当有限的“语言”做大量的工作。 尽管这一切听起来像在发牢骚（也确实如此），但实际问题不在于截图本身。在你花了几十个或几百个小时来做出这个 Mod 之后，再花几个小时为这个 Mod 截图是完全可以接受的。实际的问题是保持它们更新。你对 Mod 所做的每一个改动，最好都能在更新的截图内反映出来；如果截图过时了，对我来说就是一种缺乏关注的信号。当然也可能是我太过偏执。 当然更新的频率取决于每个 Mod 自己。如果是瓶颈这种不常改变的，那你的截图就不会过时。如果你是一个相当复杂的 GUI Mod，几乎每个版本都会在这里或那里改变你的界面的一些像素。理想情况下，一个耗时 5 分钟的 UI 修复应同时伴随更新截图，但这将让你花更多的时间在截图而非实际的开发工作上。没有人愿意这样做，因此截图总会随着时间的推移而过时。 人类心理学使这种影响更加复杂，并造成了一种恶性循环。如果你知道你的截图每隔一个版本就需要更新，你就会决定跳过更新它们，只跳这一次。下一版本无论如何都会有另一个变化，那么为什么还要现在去更新它们，这不是在浪费时间嘛。当下一个版本到来时，同样的心理会导致你再一次拖延。就这一次。永无止境地重复下去。 也许只有我是难以置信的懒惰，正常人不会有这样的问题。他们可能只会定期更新截图，因此大部分时间都会是最新的。但我不是。在实践中，它导致我大约每六个月更新一次截图。我为他们没有及时更新而烦恼，但“下次再做就好了”的心态在面对一周后就白干了的事实面前显得格外强烈。 不过，我还是想要一个解决方案。我需要一个解决方案，哪怕只是为了免除我对过期截图的自我愧疚。当然，这并不难做到。工作是不可能工作的，下周再做。自动化看来是应许之地，有时如此，有时确实如此。 我以前自动化过一些与 Mod 开发有关的流程，最知名的是构建一个新版本的流程和所有与此相关的细节管理。在这个特例中，这甚至不是因为我不想为我所有的版本做同样繁琐的步骤（至少 169 个版本的工厂规划师），更多的是为了防止我在这个过程中犯错，以免用户得到错误的版本等等，这可不妙。 快来截图吧！ 好了好了，让我们进入有趣的部分。我的想法很简单。写一个 Python 脚本来启动异星工厂进入一个自定义场景，然后接管实际的截图部分（感谢异星工厂有一个截图专用的 API 方法），之后脚本会把截图放到正确的文件夹中，也许会对它们进行一些裁剪。第一部分相当容易，我只需要弄清楚我需要哪些命令行参数，把它们串起来，然后场景就可以运行了。到目前为止，如此简单。 不过实际情况要复杂一些。为了能够截出有意义的图，我需要在不同的状态下设置各种 GUI，以显示我想要突出的功能。对地图上的实体做这种事情比较容易，因为你可以使用你通常使用的与游戏世界互动的所有 API。不过，对于 GUI 来说，它们有点自成一体，你必须构想出你自己的系统。 最大的问题来自于无法模拟一个实际的用户点击你的界面。游戏中没有任何此类 API 方法，因为任何实际的 Mod 都用不着。但这意味着你需要以某种方式来模拟点击。这有点尴尬，因为除非你的 Mod 从一开始就为此设置，或者结构非常好，否则你将需要重写你的事件处理程序或者整点黑科技。你也许能猜到我走的是哪条路。 在把黑科技整理好后，这玩意儿就能启动游戏，把界面设置成一个有趣的场景，并对用户界面的各个部分进行截图。我必须指出，所有这些都是勉强能跑，而且很有可能在 Mod 代码更改后出错。但在这一特殊情况下，没有真正的替代方案，所以我不得不忍受它。不管怎么说，建立一堆屎山代码要比一次又一次地手动拍摄相同的屏幕截图有趣得多，所以无论如何都是一种胜利。 到目前为止我对我所做的工作相当满意，但最大自动化尚未实现。你看，还有一个问题就是要把截图裁剪得更小。在工厂规划师中的许多对话框都比较小，而背景中的游戏世界会让人分心。我可以手动进行裁剪，但我不想这样做。懒。我的脑海中有一个潜在的解决方案，但它需要一些脏活。 基本想法是，在场景拍摄屏幕截图的同时，也记录下正在拍摄的对话框的尺寸。然后，这个元数据也被写入一个文件，Python 脚本可以用该文件来裁剪屏幕截图到合适的尺寸。听起来理论上是个好主意，但在现实中却遇到了一个小问题。游戏不允许你读取 GUI 窗口的尺寸，只允许写入尺寸。 禁止这么做还算合理的，因为这些尺寸实际上并不是在所有情况下都是确定的，例如，不同的游戏语言可能会改变某些元素的尺寸。在多人游戏中读取和使用这些不确定的值会导致不同步，使 Mod 与多人游戏不兼容，也会破坏重放。这似乎是一个死胡同。我是否注定要永远手动裁剪屏幕截图？事实证明，这并非我的命运。 现在，我无法解决读取对话框尺寸导致解同步的问题，这是游戏底层的运行方式。然而，我并没有在多人游戏中运行游戏来拍摄这些截图，事实证明，你已经可以在一个名为仪表模式的特殊模式下启动游戏，该模式禁用多人游戏并启用一些不安全功能。这似乎是一个完美的地方，可以塞进一个超级秘密的隐藏方法，使我能够获得关于对话框尺寸的禁忌知识。所以我就这么干了。事实证明，给 Wube 打工确实有好处。 经过几天的黑科技开发，这头野兽终于咆哮着活了过来，为我实现了屏幕截图过程的完全自动化。但还不是 完全 自动化流程。事实证明，它仍然没有完全自动化。它当然不是。我怎么会得到 完全 的满足呢。有两个步骤，我仍然需要自己做。 首先是在截图后退出游戏，以便 Python 脚本能继续执行。事实证明，Mod 不能让异星工厂退出到桌面。为了防止滥用，这是完全合理的，尽管对于仪表模式而言将是一个很好的选项。无论如何，在适当的时候按下 Alt-F4（叮）我想是能做到的。我有一个侵入性的想法，就是想办法让游戏崩溃以达到我的目的。我警告过你，这都是一堆黑科技。这个计划的问题是，游戏中很少有这样的 Bug，一旦被发现，你可以肯定 Bug 粉碎机会立即粉碎它们。 第二是将这些刚出锅的新截图上传到 Mod 门户。目前还没有合适的 API 来操作 Mod 门户网站的列表，所以我在这方面很不走运。现在，我不得不手动打开浏览器，逐一删除我的截图，然后逐一上传新的截图。真是悲剧！。也许将来会有此类 API 的希望，让我们拭目以待。 除了这两件事，我对这个结果很满意。我想这是值得的，因为我可以无限期地收获这个脚本的好处。自动化的乐趣。无限的收益。至少在它第一次坏掉之前是这样，而这可能很快就会发生。哦，好吧。 征稿 一如既往的，我们正在召集任何想要为 Alt-F4 做出贡献的人，无论是提交文章还是帮助翻译都可以。如果您有些有趣的想法，并乐于与社区分享，这里就是一个好地方。如果您没有太大把握，我们会很乐意帮助您讨论内容创意和结构问题。如果您有意参与，从加入 Discord 开始吧！","mainEntityOfPage":{"@type":"WebPage","@id":"https://alt-f4.blog/ALTF4-53/"},"url":"https://alt-f4.blog/ALTF4-53/","@type":"BlogPosting","headline":"Alt-F4 #53 - 自动化偷懒","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
	

	
	  <meta property="og:image" content="https://alt-f4.blog/assets/ALTF4/53/thumbnail.jpg">
	  <meta name="twitter:image" content="https://alt-f4.blog/assets/ALTF4/53/thumbnail.jpg">
	

	<!-- CSS & fonts -->
	<link href="/zh/assets/GLOBAL/css/titillium-web.css" rel="stylesheet">
	<link rel="stylesheet" href="/zh/assets/GLOBAL/css/style.css">
	<link rel="stylesheet" href="/zh/assets/GLOBAL/css/spidertron.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.css" rel="stylesheet" crossorigin="anonymous">
	<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,400italic%7CSignika:700,300,400,600" rel="stylesheet" type="text/css">

	<link href="/zh/assets/GLOBAL/img/favicon.ico" rel="icon" type="image/x-icon">
	<link href="/zh/assets/GLOBAL/img/favicon.ico" rel="shortcut icon" type="image/x-icon">

	<!-- RSS -->
	<link href="/zh/atom.xml" type="application/atom+xml" rel="alternate" title="ATOM Feed">

	<script src="/assets/GLOBAL/js/spidertron.js"></script>
	<script src="/assets/GLOBAL/js/localization.js"></script>
	<!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
</head>


  <body>
    <!-- Navigation Bar -->
    <nav id="top" class="top-bar">
	<div class="top-bar-inner flex flex-space-between">
		<div class="sites links flex">
			<a href="/zh/" class="sites-current">
				<div id="navbar-logo" role="img" aria-label="Alt-F4 Logo"></div>
			</a>
			<a href="https://alt-f4.blog/zh/discord" class="">Discord</a>
			<span class="separator">|</span>
			<a href="https://factorio.com/blog" class="">FFF</a>
		</div>
		<div class="sites links flex hide-tag-line">
			<em>社区驱动的 Factorio Friday Facts 后续站点</em>
		</div>
		<div class="dropdown flex-end">
			<a class="button flex flex-space-between" href="#">
				<i class="fas fa-language"></i>
			</a>
			<div class="submenu">
				
				<a class="button lang-button" href="/../ALTF4-53/" onclick="setLanguage('en')">English</a>
				
				<a class="button lang-button" href="/cs/ALTF4-53/" onclick="setLanguage('cs')">Čeština</a>
				
				<a class="button lang-button" href="/de/ALTF4-53/" onclick="setLanguage('de')">Deutsch</a>
				
				<a class="button lang-button" href="/es/ALTF4-53/" onclick="setLanguage('es')">Español</a>
				
				<a class="button lang-button" href="/fr/ALTF4-53/" onclick="setLanguage('fr')">Français</a>
				
				<a class="button lang-button" href="/it/ALTF4-53/" onclick="setLanguage('it')">Italiano</a>
				
				<a class="button lang-button" href="/nl/ALTF4-53/" onclick="setLanguage('nl')">Nederlands</a>
				
				<a class="button lang-button" href="/pt-br/ALTF4-53/" onclick="setLanguage('pt-br')">Português Brasileiro</a>
				
				<a class="button lang-button" href="/ru/ALTF4-53/" onclick="setLanguage('ru')">Русский</a>
				
				<a class="button button-green lang-button" href="/zh/ALTF4-53/" onclick="setLanguage('zh')">中文</a>
				
			</div>
		</div>
	</div>
</nav>


    <!-- Main content -->
    <div class="container">
      <div class="container-inner">
        <div class="small-center"></div>
        <!-- Posts -->
        <article class="panel blog-post">
	
	<h1 class="page-title-headder">Alt-F4 #53 - 自动化偷懒  <author>2021-11-26</author>
</h1>
	
	
	<div class="panel-inset mb0">
		
作者 <em>Therenas</em>,



编辑 <em>stringweasel, Nanogamer7, Conor_, Firerazer, MyNameIsTrez</em>,



<br>翻译 <em>Ph.X</em>






	</div>
	
	<div class="panel-inset-lighter mt0">
		<div class="post-header">
  <div class="panel">
    <div class="outer">
      <img class="inner" src="/assets/ALTF4/53/thumbnail.jpg" alt="" style="margin: 1px;">
    </div>
  </div>
  <details class="panel toc">
    <summary>
      <h2>目录</h2>
    </summary>
    <div class="panel-inset mb0">
      <ul>
  <li>
<a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%81%B7%E6%87%92-therenas">自动化偷懒 <author>Therenas</author></a>
    <ul>
      <li><a href="#%E5%BF%AB%E6%9D%A5%E6%88%AA%E5%9B%BE%E5%90%A7">快来截图吧！</a></li>
    </ul>
  </li>
  <li><a href="#%E5%BE%81%E7%A8%BF">征稿</a></li>
</ul>

    </div>
  </details>
</div>




<p>在地处黄金地段的第 53 期 Alt-F4 中，<em>Therenas</em> 大师又回来恩赐予我们一篇新文章。承接他<a href="https://alt-f4.blog/zh/ALTF4-1/">之前</a>着重于谈论自己 Mod 的<a href="https://alt-f4.blog/zh/ALTF4-17/">杰作</a>，这次是全新的复刻内容大放送。本期探讨了异星工厂中自动截图的话题。虽然实际内容只有 20% 的技术细节，此外加上 40% 的哲学和 50% 的冷笑话。你没看错，合计高达 110 点！</p>
      <h2 id="自动化偷懒-therenas">
        
        
            <a href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E5%81%B7%E6%87%92-therenas" class="anchor" style="text-decoration: none;">自动化偷懒 <author>Therenas</author></a>
          
        
      </h2>
    

<p>我经常苦恼于为<a href="https://mods.factorio.com/user/Therenas">我的 Mod</a> 拍摄适当的截图。要把一个场景设置得很吸引人 <em>并且</em> 以视觉方式解释 Mod 的核心概念，需要做很多工作。在我看来，很多 Mod 缺乏优秀截图，并非由于 Mod 作者不关心，而是因为制作好的截图真的很困难。<em>虽说</em> 一图胜千言，但截图需要他们用相当有限的“语言”做大量的工作。</p>

<p>尽管这一切听起来像在发牢骚（也确实如此），但实际问题不在于截图本身。在你花了几十个或几百个小时来做出这个 Mod 之后，再花几个小时为这个 Mod 截图是完全可以接受的。实际的问题是保持它们更新。你对 Mod 所做的每一个改动，最好都能在更新的截图内反映出来；如果截图过时了，对我来说就是一种缺乏关注的信号。当然也可能是我太过偏执。</p>

<p>当然更新的频率取决于每个 Mod 自己。如果是<a href="https://mods.factorio.com/mod/Bottleneck">瓶颈</a>这种不常改变的，那你的截图就不会过时。如果你是一个<a href="https://mods.factorio.com/mod/factoryplanner">相当复杂的 GUI Mod</a>，几乎每个版本都会在这里或那里改变你的界面的一些像素。理想情况下，一个耗时 5 分钟的 UI 修复应同时伴随更新截图，但这将让你花更多的时间在截图而非实际的开发工作上。没有人愿意这样做，因此截图总会随着时间的推移而过时。</p>

<p>人类心理学使这种影响更加复杂，并造成了一种恶性循环。如果你知道你的截图每隔一个版本就需要更新，你就会决定跳过更新它们，只跳这一次。下一版本无论如何都会有另一个变化，那么为什么还要现在去更新它们，这不是在浪费时间嘛。当下一个版本到来时，同样的心理会导致你再一次拖延。就这一次。永无止境地重复下去。</p>

<p>也许只有我是难以置信的懒惰，正常人不会有这样的问题。他们可能只会定期更新截图，因此大部分时间都会是最新的。但我不是。在实践中，它导致我大约每六个月更新一次截图。我为他们没有及时更新而烦恼，但“下次再做就好了”的心态在面对一周后就白干了的事实面前显得格外强烈。</p>

<p>不过，我还是想要一个解决方案。我需要一个解决方案，哪怕只是为了免除我对过期截图的自我愧疚。当然，这并不难做到。工作是不可能工作的，下周再做。自动化看来是应许之地，有时如此，有时确实如此。</p>

<p>我以前自动化过一些与 Mod 开发有关的流程，最知名的是<a href="https://github.com/ClaudeMetz/FactorioScripts/blob/5aab7569acdf86ff65167584638a3dd7323d2d0b/build_release.py">构建</a>一个新版本的流程和所有与此相关的细节管理。在这个特例中，这甚至不是因为我不想为我所有的版本做同样繁琐的步骤（<a href="https://mods.factorio.com/mod/factoryplanner/downloads">至少 169 个版本</a>的工厂规划师），更多的是为了防止我在这个过程中犯错，以免用户得到错误的版本等等，这可不妙。</p>
      <h3 id="快来截图吧">
        
        
            <a href="#%E5%BF%AB%E6%9D%A5%E6%88%AA%E5%9B%BE%E5%90%A7" class="anchor" style="text-decoration: none;">快来截图吧！</a>
          
        
      </h3>
    

<p>好了好了，让我们进入有趣的部分。我的想法很简单。写一个 <a href="https://github.com/ClaudeMetz/FactorioScripts/blob/5aab7569acdf86ff65167584638a3dd7323d2d0b/take_screenshots.py">Python 脚本</a>来启动异星工厂进入一个<a href="https://github.com/ClaudeMetz/FactoryPlanner/tree/master/scenarios/screenshotter">自定义场景</a>，然后接管实际的截图部分（感谢异星工厂有一个<a href="https://lua-api.factorio.com/latest/LuaGameScript.html#LuaGameScript.take_screenshot">截图专用的 API 方法</a>），之后脚本会把截图放到正确的文件夹中，也许会对它们进行一些裁剪。第一部分相当容易，我只需要弄清楚我需要哪些<a href="https://wiki.factorio.com/Command_line_parameters">命令行参数</a>，把它们串起来，然后场景就可以运行了。到目前为止，如此简单。</p>

<p>不过实际情况要复杂一些。为了能够截出有意义的图，我需要在不同的状态下设置各种 GUI，以显示我想要突出的功能。对地图上的实体做这种事情比较容易，因为你可以使用你通常使用的与游戏世界互动的所有 API。不过，对于 GUI 来说，它们有点自成一体，你必须构想出你自己的系统。</p>

<p>最大的问题来自于无法模拟一个实际的用户点击你的界面。游戏中没有任何此类 API 方法，因为任何实际的 Mod 都用不着。但这意味着你需要以某种方式来模拟点击。这有点尴尬，因为除非你的 Mod 从一开始就为此设置，或者结构非常好，否则你将需要重写你的事件处理程序或者整点黑科技。你也许能猜到我走的是哪条路。</p>

<p>在把<a href="https://github.com/ClaudeMetz/FactoryPlanner/blob/master/modfiles/data/handlers/screenshotter.lua">黑科技</a>整理好后，这玩意儿就能启动游戏，把界面设置成一个有趣的场景，并对用户界面的各个部分进行截图。我必须指出，所有这些都是勉强能跑，而且很有可能在 Mod 代码更改后出错。但在这一特殊情况下，没有真正的替代方案，所以我不得不忍受它。不管怎么说，建立一堆屎山代码要比一次又一次地手动拍摄相同的屏幕截图有趣得多，所以无论如何都是一种胜利。</p>

<p>到目前为止我对我所做的工作相当满意，但最大自动化尚未实现。你看，还有一个问题就是要把截图裁剪得更小。在工厂规划师中的许多对话框都比较小，而背景中的游戏世界会让人分心。我可以手动进行裁剪，但我不想这样做。<em>懒</em>。我的脑海中有一个潜在的解决方案，但它需要一些脏活。</p>

<p>基本想法是，在场景拍摄屏幕截图的同时，也记录下正在拍摄的对话框的尺寸。然后，这个元数据也被写入一个文件，Python 脚本可以用该文件来裁剪屏幕截图到合适的尺寸。听起来理论上是个好主意，但在现实中却遇到了一个小问题。游戏不允许你读取 GUI 窗口的尺寸，只允许写入尺寸。</p>

<p>禁止这么做还算合理的，因为这些尺寸实际上并不是在所有情况下都是确定的，例如，不同的游戏语言可能会改变某些元素的尺寸。在多人游戏中读取和使用这些不确定的值会导致不同步，使 Mod 与多人游戏不兼容，也会破坏重放。这似乎是一个死胡同。我是否注定要永远手动裁剪屏幕截图？事实证明，这并非我的命运。</p>

<p>现在，我无法解决读取对话框尺寸导致解同步的问题，这是游戏底层的运行方式。然而，我并没有在多人游戏中运行游戏来拍摄这些截图，事实证明，你已经可以在一个名为<a href="https://lua-api.factorio.com/latest/Instrument.html">仪表模式</a>的特殊模式下启动游戏，该模式禁用多人游戏并启用一些不安全功能。这似乎是一个完美的地方，可以塞进一个超级秘密的隐藏方法，使我能够获得关于对话框尺寸的禁忌知识。所以我就这么干了。事实证明，给 Wube 打工确实有好处。</p>

<p>经过几天的黑科技开发，这头野兽终于咆哮着活了过来，为我实现了屏幕截图过程的完全自动化。但还不是 <em>完全</em> 自动化流程。事实证明，它仍然没有完全自动化。它当然不是。我怎么会得到 <em>完全</em> 的满足呢。有两个步骤，我仍然需要自己做。</p>

<p>首先是在截图后退出游戏，以便 Python 脚本能继续执行。事实证明，Mod 不能让异星工厂退出到桌面。为了防止滥用，这是完全合理的，尽管对于仪表模式而言将是一个很好的选项。无论如何，在适当的时候按下 Alt-F4（<em>叮</em>）我想是能做到的。我有一个侵入性的想法，就是想办法让游戏崩溃以达到我的目的。我警告过你，这都是一堆黑科技。这个计划的问题是，游戏中很少有这样的 Bug，一旦被发现，你可以肯定 Bug 粉碎机会立即粉碎它们。</p>

<p>第二是将这些刚出锅的新截图上传到 Mod 门户。目前还没有合适的 API 来操作 Mod 门户网站的列表，所以我在这方面很不走运。现在，我不得不手动打开浏览器，逐一删除我的截图，然后逐一上传新的截图。<em>真是悲剧！</em>。也许将来会有此类 API 的希望，让我们拭目以待。</p>

<p>除了这两件事，我对这个结果很满意。我想这是值得的，因为我可以无限期地收获这个脚本的好处。自动化的乐趣。<em>无限的收益</em>。至少在它第一次坏掉之前是这样，而这可能很快就会发生。哦，好吧。</p>
      <h2 id="征稿">
        
        
            <a href="#%E5%BE%81%E7%A8%BF" class="anchor" style="text-decoration: none;">征稿</a>
          
        
      </h2>
    

<p>一如既往的，我们正在召集任何想要为 Alt-F4 做出贡献的人，无论是提交文章还是帮助翻译都可以。如果您有些有趣的想法，并乐于与社区分享，这里就是一个好地方。如果您没有太大把握，我们会很乐意帮助您讨论内容创意和结构问题。如果您有意参与，从加入 <a href="https://alt-f4.blog/zh/discord">Discord</a> 开始吧！</p>





<script>
  (() => {
    if (window.innerWidth >= 720) {
      document.getElementsByClassName('toc')[0].setAttribute('open', '')
    }
  })()
</script>

		
<div class="flex flex-column flex-items-center mt8">
  
  <a class="button-green-right m4" style="width: 16em;" href="https://forums.factorio.com/viewtopic.php?f=5&t=100767">
    去 Factorio 论坛
  </a>
  
  
  <a class="button-green-right m4" style="width: 16em;" href="https://www.reddit.com/r/factorio/comments/r2nopu/altf4_53_laziness_through_automation/">
    去 Reddit 上讨论
  </a>
  
  
  <a class="button-green-right m4" style="width: 16em;" href="https://alt-f4.blog/zh/discord">
    去 Discord 上讨论
  </a>
  
</div>


	</div>
	<div class="panel-inset mb0 p4 flex">
		<div>
		<!-- Previous Button -->
		
		<a href="/zh/ALTF4-52/" class="button square-sm"><i class="fas fa-angle-double-left"></i></a>
		
		<a class="button square-sm" href="/zh/">
			<i class="fas fa-home"></i>
		</a>

		<!-- Next Button -->
		
		<a class="button square-sm  disabled">
			<i class="fas fa-angle-double-right"></i>
		</a>
		
		</div>
	</div>
</article>

      </div>
    </div>


    <!-- Footer -->
    <footer class="footer">
  <div class="footer-inner panel">

    <div class="footer-links panel-inset slots p1 mt0 mb0">
      <a href="/zh/about" class="slot" title="About">
        <div class="slot-button">
          <i class="fas fa-info"></i>
        </div>
      </a>
      <a href="https://github.com/AlternativeFFFF/Alt-F4" class="slot" title="Github">
        <div class="slot-button">
          <i class="fab fa-github"></i>
        </div>
      </a>
      <a href="https://alt-f4.blog/zh/discord" class="slot" title="Discord">
        <div class="slot-button">
          <i class="fab fa-discord"></i>
        </div>
      </a>
      <a href="/zh/atom.xml" type="application/atom+xml" rel="alternate" class="slot" title="ATOM Feed">
        <div class="slot-button">
          <i class="fas fa-rss"></i>
        </div>
      </a>
      <a href="https://www.freelists.org/list/alt-f4" class="slot" title="Email Newsletter">
        <div class="slot-button">
          <i class="fas fa-envelope"></i>
        </div>
      </a>

      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
      <div class="slot">
        <div class="slot-empty"></div>
      </div>
    </div>
    <div class="footer-rocket panel-inset m0">
      <div class="spidertron-center">
        <div id="spidertron" class="spidertron-home" data-spidertron-scale="0.6" data-spidertron-speed="400"></div>
      </div>
      <div class="shadow-overlay"></div>
      <div class="shadow-overlay-bottom"></div>
    </div>
    <div class="footer-copyright panel-inset m0">
      这是一个饭制站点，与下列网站没有直接关联 Wube Software
    </div>
  </div>
</footer>

  </body>

</html>
